{% extends 'base.html' %}
{% load static %}
{% block title %}{{ block.super }}
| Recipe results
{% endblock %}
{% block content %}
<div class="container">
    <div class="row mb-3">
    <!-- This displays how many recipes there exists from the search query-->
    {% if recipes|length == 1 %}
    <h2>Found {{ recipes|length }} recipe that contains {{ recipe_name }}:</h2>
    {% else %}
    <h2>Found {{ recipes|length }} recipes that contains {{ recipe_name }}:</h2>
    {%  endif %}

    </div>
    <div class="row">

        <!-- loops through all recipes from the search query-->
        {% for recipe in recipes %}
        <div class="col-md-3">
            <div class="card mb-4">
                <img class="card-img-top img-fluid" src="{{MEDIA_ROOT}}{{ recipe.image.url }}" alt="Card image cap">
                <div class="card-body">
                    <h4 class="card-title"><a href="{% url 'recipe:recipe-detail' recipe.id %}">{{ recipe.name }}</a>
                        <!-- adds a chefshat to recipes made by a user with the group chef-->
                                        {% for group in recipe.user.groups.all %}
                        {% if group.name == "chef" %}
                        <img src="{% static "browse/images/chef_hat.png" %}" alt="" height="20" width="20">
                        {% endif %}
                    {% endfor %}</h4>
                    <h6 class="card-text">{{ recipe.description }}</h6>
                    <!-- Creates a link from a users name listed in recipes to their profile. If you click on your own name
                it redirects to your own profile page as if you clicked the My profile tab. otherwise it links to that other persons profile
                -->
                                {% if recipe.user == request.user %}
                <p class="card-text"><small class="text-muted"><a href="{% url 'users:profile' %}">{{ recipe.user }}</a></small></p>
                {% else %}
                    <p class="card-text"><small class="text-muted"><a href="{% url 'users:user-detail' recipe.user %}">{{ recipe.user }}</a></small></p>
                {% endif %}
                    <!-- adds a favourite button that adds the recipe to the logged in users favourites-->
                                {% if user not in recipe.favourite.all %}
            <a href="{% url 'recipe:change_favourite' pk=recipe.pk operation='add'%}">
            <i class="far fa-heart fa-lg" style="font-size:24px;"></i>


            </a>
                {% else %}
                <a href="{% url 'recipe:change_favourite' pk=recipe.pk operation='remove'%}">
            <i class="fa fa-heart" style="font-size:24px;color:#0000FF"></i>


            </a>
            {% endif %}
                </div>
            </div>
        </div>
            <!-- adds a new line of recipes for the next to go if its the fourth recipe in the line-->
            <!-- if last column in row -->
        {% if forloop.counter|divisibleby:"4" and not forloop.last %}
            </div><div class="row">
        {% endif %}

        {% endfor %}

    </div>
</div>

{% endblock content %}

